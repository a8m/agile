/**
 * Like Underscore, but with zero callbacks and really more fun
 * @version v0.0.2 - 2014-11-15 * @link https://github.com/a8m/agile
 * @author Ariel Mashraki <ariel@mashraki.co.il>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */!function(a,b){"use strict";function c(a,b){return b=Error,function(c){var d=Array.prototype.slice.call(arguments,1),e="["+a+":]"+c.replace(/{(\d+)}/g,function(a,b){return P(d[b])?a:d[b]});return b(e)}}function d(a){return function(){return a}}function e(a,b,c){var d,f;if(a)if(S(a))for(d in a)"prototype"==d||"length"==d||"name"==d||a.hasOwnProperty&&!a.hasOwnProperty(d)||b.call(c,a[d],d,a);else if(Lb(a)||h(a)){var g="object"!=typeof a;for(d=0,f=a.length;f>d;d++)(g||d in a)&&b.call(c,a[d],d,a)}else if(a.forEach&&a.forEach!==e)a.forEach(b,c,a);else for(d in a)a.hasOwnProperty(d)&&b.call(c,a[d],d,a);return a}function f(a,b,c){var d=0;return a.filter(function(a){var e=Q(c)?b>d&&c(a):b>d;return d=e?d+1:d,e})}function g(a,b,c){var d=b.map(function(a){return Xb(c)(a)});return d.indexOf(Math[a].apply(Math,d))}function h(a){if(null==a||i(a))return!1;var b=a.length;return a.nodeType===Kb&&b?!0:M(a)||Lb(a)||0===b||"number"==typeof b&&b>0&&b-1 in a}function i(a){return a&&a.window===a}function j(a,b,c){for(var d,e=-1;++e<a.length;)if(b(a[e])){d=c?e:a[e];break}return d}function k(a,b){if(!Lb(a)||P(b))return a;var c=a.map(function(a){return Xb(b)(a)}).indexOf(!0);return a.slice(-1===c?0:c)}function l(a,b){return Lb(a)?a.slice(b):a}function m(a,b){if(!Lb(a)||P(b))return a;var c=a.map(function(a){return Xb(b)(a)}).indexOf(!0);return a.slice(0,-1===c?a.length:++c)}function n(a,b){return Lb(a)?a.slice(0,b?--b:b):a}function o(a,b){return!Lb(a)||P(b)?!0:a.some(function(a){return N(a)||S(b)?Xb(b)(a):a===b})}function p(a,b){var c,d={};return!Lb(a)||P(b)?a:(a.forEach(function(a){c=Xb(b)(a),d[c]||(d[c]=0),d[c]++}),d)}function q(a,b){if(!Lb(a)||!N(b))return a;var c=Z(b);return a.forEach(function(a){c.forEach(function(c){var d=Xb(c),e=d.assign;P(d(a))&&e(a,d(b))})}),a}function r(a,b){return!Lb(a)||P(b)?!0:a.every(function(a){return N(a)||S(b)?Xb(b)(a):a===b})}function s(a,b){return!Lb(a)||P(b)?a:a.filter(function(a){return N(a)||S(b)?Xb(b)(a):a===b})}function t(a,b){return Lb(a)&&Q(b)?j(a,Xb(b),!0):a}function u(a,b){if(!Lb(a)||P(b))return a;var c=a.length-1-j(I(a),Xb(b),!0);return c===c?c:-1}function v(a,b){return Lb(a)&&Q(b)?j(I(a),Xb(b),!1):a}function w(a,b){return Lb(a)&&Q(b)?j(a,Xb(b),!1):a}function x(a){var c,d,e;return Lb(a)?(e=Array.prototype.slice.call(arguments,1),c=O(e[0])?e[0]:1,d=O(e[0])?O(e[1])?b:e[1]:e[0],e.length?f(a,c,d?Xb(d):d):a[0]):a}function y(a,b){return b=b||!1,Lb(a)?b?[].concat.apply([],a):z(a,0):a}function z(a,b){return b=b||0,b>=a.length?a:Lb(a[b])?z(a.slice(0,b).concat(a[b],a.slice(b+1)),b):z(a,b+1)}function A(a,b){var c,d={},f=Xb(b);return!Lb(a)||P(b)?a:(e(a,function(a){c=f(a),d[c]||(d[c]=[]),d[c].push(a)}),d)}function B(a){var c,d,e,g;return Lb(a)?(g=a.slice(),e=Array.prototype.slice.call(arguments,1),c=O(e[0])?e[0]:1,d=O(e[0])?O(e[1])?b:e[1]:e[0],e.length?f(g.reverse(),c,d?Xb(d):d).reverse():g[g.length-1]):a}function C(a,b){return!Lb(a)||P(b)?a:a.map(function(a){return Xb(b)(a)})}function D(a,b){return Lb(a)?P(b)?Math.max.apply(Math,a):a[g("max",a,b)]:a}function E(a,b){return Lb(a)?P(b)?Math.min.apply(Math,a):a[g("min",a,b)]:a}function F(a,b){return!Lb(a)||P(b)?a:a.filter(function(a){return N(a)||S(b)?!Xb(b)(a):a!==b})}function G(a,b,c){function d(a,c){for(var d=0;d<b.length;d++){var e=b[d](a,c);if(0!==e)break}return e}function e(a,b){return b?function(b,c){return a(c,b)}:a}function f(a,b){var c=typeof a,d=typeof b;return c==d?(R(a)&&R(b)&&(a=a.valueOf(),b=b.valueOf()),"string"==c&&(a=a.toLowerCase(),b=b.toLowerCase()),a===b?0:b>a?-1:1):d>c?-1:1}if(!h(a))return a;b=Lb(b)?b:[b],0===b.length&&(b=["+"]),b=b.map(function(a){var b=!1,c=a||nb;if(M(a)){if(("+"==a.charAt(0)||"-"==a.charAt(0))&&(b="-"==a.charAt(0),a=a.substring(1)),""===a)return e(function(a,b){return f(a,b)},b);if(c=Xb(a),c.constant){var d=c();return e(function(a,b){return f(a[d],b[d])},b)}}return e(function(a,b){return f(c(a),c(b))},b)});for(var g=[],i=0;i<a.length;i++)g.push(a[i]);return g.sort(e(d,c))}function H(a){var b=Array.prototype.slice.call(arguments,1);return!Lb(a)||U(b)?a:a.filter(function(a){return!b.some(function(b){return mb(b,a)})})}function I(a){return M(a)?a.split("").reverse().join(""):Lb(a)?a.slice().reverse():a}function J(a,b){return Lb(a)?a.reduce(function(a,b){return a+b},b||0):a}function K(a,b){function c(a,b){return P(b)?!1:a.some(function(a){return mb(a,b)})}if(!Lb(a))return a;var d=[],e=Xb(b);return a.filter(P(b)?function(a,b,c){return c.indexOf(a)===b}:function(a){var b=e(a);return c(d,b)?!1:(d.push(b),!0)})}function L(a,b,c){function d(a,b){var d=Xb(c);return b.some(function(b){return c?mb(d(b),d(a)):mb(b,a)})}return c=c||!1,Lb(a)&&Lb(b)?a.concat(b).filter(function(c){return!(d(c,a)&&d(c,b))}):a}function M(a){return"string"==typeof a}function N(a){return null!==a&&"object"==typeof a}function O(a){return"number"==typeof a}function P(a){return"undefined"==typeof a}function Q(a){return"undefined"!=typeof a}function R(a){return"[object Date]"===toString.call(a)}function S(a){return"function"==typeof a}function T(a){return"[object RegExp]"===toString.call(a)}function U(a){return M(a)||Lb(a)?!a.length:!1}function V(a){return"boolean"==typeof a}function W(a){var b=Array.prototype.slice.call(arguments,1);return e(b,function(b,c){switch(typeof a){case"object":Lb(a)?a.push(b):ob(a,N(b)?b:X(c,b));break;case"string":a+=M(b)?b:"";break;case"number":a+=O(b)?b:0}}),a}function X(a,b){var c={};return c[a]=b,c}function Y(a,b){return N(a)?b?Z(a):Object.keys(a):a}function Z(a,b,c){b=b||[];var d=Object.keys(a);return d.forEach(function(d){if(N(a[d])&&!Lb(a[d])){var e=c?c+"."+d:c;Z(a[d],b,e||d)}else{var f=c?c+"."+d:d;b.push(f)}}),b}function $(a,b){return N(a)?Object.keys(a).map(function(c){return b?ob(a[c],{$key:c}):a[c]}):a}function _(a,b,c){var d,e=c||!1;return!M(a)||P(b)?a:(a=e?a:a.toLowerCase(),d=a.length-b.length,-1!==a.indexOf(e?b:b.toLowerCase(),d))}function ab(a,b){var c=b||"\\s";return M(a)?a.replace(new RegExp("^"+c+"+"),""):a}function bb(a,b){var c=~~b;return M(a)&&c?cb(a,b):a}function cb(a,b){var c="";do 1&b&&(c+=a),a+=a;while(b>>=1);return c}function db(a,b){var c=b||"\\s";return M(a)?a.replace(new RegExp(c+"+$"),""):a}function eb(a,b){var c=b||"-";return M(a)?a.toLowerCase().replace(/\s+/g,c):a}function fb(a,b,c){var d=c||!1;return!M(a)||P(b)?a:(a=d?a:a.toLowerCase(),!a.indexOf(d?b:b.toLowerCase()))}function gb(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/{(\d+)}/g,function(a,c){return P(b[c])?a:b[c]})}function hb(a){return M(a)?a.replace(/<\S[^><]*>/g,""):a}function ib(a,b){var c=b||"\\s";return M(a)?a.replace(new RegExp("^"+c+"+|"+c+"+$","g"),""):a}function jb(a,b,c,d){return b=P(b)?a.length:b,d=d||!1,c=c||"",!M(a)||a.length<=b?a:a.substring(0,d?-1===a.indexOf(" ",b)?a.length:a.indexOf(" ",b):b)+c}function kb(a){return M(a)?a.split(" ").map(function(a){return a.charAt(0).toUpperCase()+a.substring(1)}).join(" "):a}function lb(a,b,c){return!M(a)||P(b)?a:[b,a,c||b].join("")}function mb(a,c){if(a===c)return!0;if(null===a||null===c)return!1;if(a!==a&&c!==c)return!0;var d,e,f,g=typeof a,h=typeof c;if(g==h&&"object"==g){if(!Lb(a)){if(R(a))return R(c)?mb(a.getTime(),c.getTime()):!1;if(T(a)&&T(c))return a.toString()==c.toString();if(i(a)||i(c)||Lb(c))return!1;f={};for(e in a)if(!S(a[e])){if(!mb(a[e],c[e]))return!1;f[e]=!0}for(e in c)if(!f.hasOwnProperty(e)&&c[e]!==b&&!S(c[e]))return!1;return!0}if(!Lb(c))return!1;if((d=a.length)==c.length){for(e=0;d>e;e++)if(!mb(a[e],c[e]))return!1;return!0}}return!1}function nb(a){return a}function ob(a){for(var b=1,c=arguments.length;c>b;b++){var d=arguments[b];if(d)for(var e=Object.keys(d),f=0,g=e.length;g>f;f++){var h=e[f];a[h]=d[h]}}return a}function pb(){return Object.create(null)}function qb(){}function rb(a){return"undefined"==typeof a?b:JSON.stringify(a)}function sb(a,b,c,d){if(i(a))throw Error("Can't copy! Making copies of Window instances is not supported.");if(b){if(a===b)throw Error("Can't copy! Source and destination are identical.");if(c=c||[],d=d||[],N(a)){var f=c.indexOf(a);if(-1!==f)return d[f];c.push(a),d.push(b)}var g;if(Lb(a)){b.length=0;for(var h=0;h<a.length;h++)g=sb(a[h],null,c,d),N(a[h])&&(c.push(a[h]),d.push(g)),b.push(g)}else{Lb(b)?b.length=0:e(b,function(a,c){delete b[c]});for(var j in a)a.hasOwnProperty(j)&&(g=sb(a[j],null,c,d),N(a[j])&&(c.push(a[j]),d.push(g)),b[j]=g)}}else if(b=a,a)if(Lb(a))b=sb(a,[],c,d);else if(R(a))b=new Date(a.getTime());else if(T(a))b=new RegExp(a.source,a.toString().match(/[^\/]*$/)[0]),b.lastIndex=a.lastIndex;else if(N(a)){var k=Object.create(Object.getPrototypeOf(a));b=sb(a,k,c,d)}return b}function tb(a,b){if("__defineGetter__"===a||"__defineSetter__"===a||"__lookupGetter__"===a||"__lookupSetter__"===a||"__proto__"===a)throw Jb("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",b);return a}function ub(a,b){if(a){if(a.constructor===a)throw Jb("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",b);if(a.window===a)throw Jb("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",b);if(a.children&&(a.nodeName||a.prop&&a.attr&&a.find))throw Jb("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",b);if(a===Object)throw Jb("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",b)}return a}function vb(a,b){if(a){if(a.constructor===a)throw Jb("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",b);if(a===Ob||a===Pb||a===Qb)throw Jb("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",b)}}function wb(a){return a.constant}function xb(a,b,c,d){ub(a,d);for(var e,f=b.split("."),g=0;f.length>1;g++){e=tb(f.shift(),d);var h=ub(a[e],d);h||(h={},a[e]=h),a=h}return e=tb(f.shift(),d),ub(a[e],d),a[e]=c,c}function yb(a,c,d,e,f,g){return tb(a,g),tb(c,g),tb(d,g),tb(e,g),tb(f,g),function(g,h){var i=h&&h.hasOwnProperty(a)?h:g;return null==i?i:(i=i[a],c?null==i?b:(i=i[c],d?null==i?b:(i=i[d],e?null==i?b:(i=i[e],f?null==i?b:i=i[f]:i):i):i):i)}}function zb(a,c,f){var g=Wb[a];if(g)return g;var h=a.split("."),i=h.length;if(c.csp)g=6>i?yb(h[0],h[1],h[2],h[3],h[4],f):function(a,c){var d,e=0;do d=yb(h[e++],h[e++],h[e++],h[e++],h[e++],f)(a,c),c=b,a=d;while(i>e);return d};else{var j="";e(h,function(a,b){tb(a,f),j+="if(s == null) return undefined;\ns="+(b?"s":'((l&&l.hasOwnProperty("'+a+'"))?l:s)')+"."+a+";\n"}),j+="return s;";var k=new Function("s","l",j);k.toString=d(j),g=k}return g.sharedGetter=!0,g.assign=function(b,c){return xb(b,a,c,a)},Wb[a]=g,g}function Ab(a,b,c){e(b,function(b){var d=M(b)?b:b.name,e=M(b)?c[b]:N(b)?b.action:b,f=M(b)&&!c.E;a.prototype[d]=function(){var a=Array.prototype.slice.call(arguments),b=[this.__value__].concat(a),c=f?e.call(this.__value__,a):e.apply(this,b);return Yb.test(d)||V(c)?c:Hb(c)}})}function Bb(a,b){e(b,function(b){a[b.name]=S(b)?b:b.action})}function Cb(a){this.__value__=a}function Db(a){this.__value__=a}function Eb(a){this.__value__=a}function Fb(a){this.__value__=a}function Gb(a){switch(typeof a){case"string":return Cb;case"number":return Fb;case"object":return Lb(a)?Db:Eb;default:throw Error("Agile value can't be ["+typeof a+"] as an argument")}}function Hb(a){if(a&&a.__wrapped__)return a;var b,c=Gb(a);return(b=new c(a)).__wrapped__=!0,b}function Ib(a){return"object"==typeof module&&module&&module.exports===a?module.exports=Hb:a[a._?"agile":"_"]=Hb}var Jb=c("$parse"),Kb=(Object.prototype.hasOwnProperty,1),Lb=Array.isArray,Mb=function(a){return M(a)?a.toUpperCase():a},Nb=function(a){return M(a)?a.toLowerCase():a},Ob=Function.prototype.call,Pb=Function.prototype.apply,Qb=Function.prototype.bind,Rb=pb();e({"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:function(){}},function(a,b){a.constant=a.literal=a.sharedGetter=!0,Rb[b]=a}),Rb["this"]=function(a){return a},Rb["this"].sharedGetter=!0;var Sb=ob(pb(),{"+":function(a,c,d,e){return d=d(a,c),e=e(a,c),Q(d)?Q(e)?d+e:d:Q(e)?e:b},"-":function(a,b,c,d){return c=c(a,b),d=d(a,b),(Q(c)?c:0)-(Q(d)?d:0)},"*":function(a,b,c,d){return c(a,b)*d(a,b)},"/":function(a,b,c,d){return c(a,b)/d(a,b)},"%":function(a,b,c,d){return c(a,b)%d(a,b)},"===":function(a,b,c,d){return c(a,b)===d(a,b)},"!==":function(a,b,c,d){return c(a,b)!==d(a,b)},"==":function(a,b,c,d){return c(a,b)==d(a,b)},"!=":function(a,b,c,d){return c(a,b)!=d(a,b)},"<":function(a,b,c,d){return c(a,b)<d(a,b)},">":function(a,b,c,d){return c(a,b)>d(a,b)},"<=":function(a,b,c,d){return c(a,b)<=d(a,b)},">=":function(a,b,c,d){return c(a,b)>=d(a,b)},"&&":function(a,b,c,d){return c(a,b)&&d(a,b)},"||":function(a,b,c,d){return c(a,b)||d(a,b)},"!":function(a,b,c){return!c(a,b)},"=":!0,"|":!0}),Tb={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},Ub=function(a){this.options=a};Ub.prototype={constructor:Ub,lex:function(a){for(this.text=a,this.index=0,this.ch=b,this.tokens=[];this.index<this.text.length;)if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent();else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch}),this.index++;else if(this.isWhitespace(this.ch))this.index++;else{var c=this.ch+this.peek(),d=c+this.peek(2),e=Sb[this.ch],f=Sb[c],g=Sb[d];g?(this.tokens.push({index:this.index,text:d,fn:g}),this.index+=3):f?(this.tokens.push({index:this.index,text:c,fn:f}),this.index+=2):e?(this.tokens.push({index:this.index,text:this.ch,fn:e}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}return this.tokens},is:function(a){return-1!==a.indexOf(this.ch)},peek:function(a){var b=a||1;return this.index+b<this.text.length?this.text.charAt(this.index+b):!1},isNumber:function(a){return a>="0"&&"9">=a},isWhitespace:function(a){return" "===a||"\r"===a||"	"===a||"\n"===a||""===a||"Â "===a},isIdent:function(a){return a>="a"&&"z">=a||a>="A"&&"Z">=a||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,b,c){c=c||this.index;var d=Q(b)?"s "+b+"-"+this.index+" ["+this.text.substring(b,c)+"]":" "+c;throw Jb("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",a,d,this.text)},readNumber:function(){for(var a="",b=this.index;this.index<this.text.length;){var c=Nb(this.text.charAt(this.index));if("."==c||this.isNumber(c))a+=c;else{var d=this.peek();if("e"==c&&this.isExpOperator(d))a+=c;else if(this.isExpOperator(c)&&d&&this.isNumber(d)&&"e"==a.charAt(a.length-1))a+=c;else{if(!this.isExpOperator(c)||d&&this.isNumber(d)||"e"!=a.charAt(a.length-1))break;this.throwError("Invalid exponent")}}this.index++}a=1*a,this.tokens.push({index:b,text:a,constant:!0,fn:function(){return a}})},readIdent:function(){for(var a,c,d,e,f=this.text,g="",h=this.index;this.index<this.text.length&&(e=this.text.charAt(this.index),"."===e||this.isIdent(e)||this.isNumber(e));)"."===e&&(a=this.index),g+=e,this.index++;if(a&&"."===g[g.length-1]&&(this.index--,g=g.slice(0,-1),a=g.lastIndexOf("."),-1===a&&(a=b)),a)for(c=this.index;c<this.text.length;){if(e=this.text.charAt(c),"("===e){d=g.substr(a-h+1),g=g.substr(0,a-h),this.index=c;break}if(!this.isWhitespace(e))break;c++}this.tokens.push({index:h,text:g,fn:Rb[g]||zb(g,this.options,f)}),d&&(this.tokens.push({index:a,text:"."}),this.tokens.push({index:a+1,text:d}))},readString:function(a){var b=this.index;this.index++;for(var c="",d=a,e=!1;this.index<this.text.length;){var f=this.text.charAt(this.index);if(d+=f,e){if("u"===f){var g=this.text.substring(this.index+1,this.index+5);g.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+g+"]"),this.index+=4,c+=String.fromCharCode(parseInt(g,16))}else{var h=Tb[f];c+=h||f}e=!1}else if("\\"===f)e=!0;else{if(f===a)return this.index++,void this.tokens.push({index:b,text:d,string:c,constant:!0,fn:function(){return c}});c+=f}this.index++}this.throwError("Unterminated quote",b)}};var Vb=function(a,b){this.lexer=a,this.options=b};Vb.ZERO=ob(function(){return 0},{sharedGetter:!0,constant:!0}),Vb.prototype={constructor:Vb,parse:function(a){this.text=a,this.tokens=this.lexer.lex(a);var b=this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),b.literal=!!b.literal,b.constant=!!b.constant,b},primary:function(){var a;if(this.expect("("))a=this.filterChain(),this.consume(")");else if(this.expect("["))a=this.arrayDeclaration();else if(this.expect("{"))a=this.object();else{var b=this.expect();a=b.fn,a||this.throwError("not a primary expression",b),b.constant&&(a.constant=!0,a.literal=!0)}for(var c,d;c=this.expect("(","[",".");)"("===c.text?(a=this.functionCall(a,d),d=null):"["===c.text?(d=a,a=this.objectIndex(a)):"."===c.text?(d=a,a=this.fieldAccess(a)):this.throwError("IMPOSSIBLE");return a},throwError:function(a,b){throw Jb("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",b.text,a,b.index+1,this.text,this.text.substring(b.index))},peekToken:function(){if(0===this.tokens.length)throw Jb("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(a,b,c,d){if(this.tokens.length>0){var e=this.tokens[0],f=e.text;if(f===a||f===b||f===c||f===d||!a&&!b&&!c&&!d)return e}return!1},expect:function(a,b,c,d){var e=this.peek(a,b,c,d);return e?(this.tokens.shift(),e):!1},consume:function(a){this.expect(a)||this.throwError("is unexpected, expecting ["+a+"]",this.peek())},unaryFn:function(a,b){return ob(function(c,d){return a(c,d,b)},{constant:b.constant,inputs:[b]})},binaryFn:function(a,b,c,d){return ob(function(d,e){return b(d,e,a,c)},{constant:a.constant&&c.constant,inputs:!d&&[a,c]})},statements:function(){for(var a=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&a.push(this.filterChain()),!this.expect(";"))return 1===a.length?a[0]:function(b,c){for(var d,e=0,f=a.length;f>e;e++)d=a[e](b,c);return d}},filterChain:function(){for(var a,b=this.expression();a=this.expect("|");)b=!0;return b},expression:function(){return this.assignment()},assignment:function(){var a,b,c=this.ternary();return(b=this.expect("="))?(c.assign||this.throwError("implies assignment but ["+this.text.substring(0,b.index)+"] can not be assigned to",b),a=this.ternary(),ob(function(b,d){return c.assign(b,a(b,d),d)},{inputs:[c,a]})):c},ternary:function(){var a,b,c=this.logicalOR();if(b=this.expect("?")){if(a=this.assignment(),b=this.expect(":")){var d=this.assignment();return ob(function(b,e){return c(b,e)?a(b,e):d(b,e)},{constant:c.constant&&a.constant&&d.constant})}this.throwError("expected :",b)}return c},logicalOR:function(){for(var a,b=this.logicalAND();a=this.expect("||");)b=this.binaryFn(b,a.fn,this.logicalAND(),!0);return b},logicalAND:function(){var a,b=this.equality();return(a=this.expect("&&"))&&(b=this.binaryFn(b,a.fn,this.logicalAND(),!0)),b},equality:function(){var a,b=this.relational();return(a=this.expect("==","!=","===","!=="))&&(b=this.binaryFn(b,a.fn,this.equality())),b},relational:function(){var a,b=this.additive();return(a=this.expect("<",">","<=",">="))&&(b=this.binaryFn(b,a.fn,this.relational())),b},additive:function(){for(var a,b=this.multiplicative();a=this.expect("+","-");)b=this.binaryFn(b,a.fn,this.multiplicative());return b},multiplicative:function(){for(var a,b=this.unary();a=this.expect("*","/","%");)b=this.binaryFn(b,a.fn,this.unary());return b},unary:function(){var a;return this.expect("+")?this.primary():(a=this.expect("-"))?this.binaryFn(Vb.ZERO,a.fn,this.unary()):(a=this.expect("!"))?this.unaryFn(a.fn,this.unary()):this.primary()},fieldAccess:function(a){var b=this.text,c=this.expect().text,d=zb(c,this.options,b);return ob(function(b,c,e){return d(e||a(b,c))},{assign:function(d,e,f){var g=a(d,f);return g||a.assign(d,g={}),xb(g,c,e,b)}})},objectIndex:function(a){var c=this.text,d=this.expression();return this.consume("]"),ob(function(e,f){var g,h=a(e,f),i=d(e,f);return tb(i,c),h?g=ub(h[i],c):b},{assign:function(b,e,f){var g=tb(d(b,f),c),h=ub(a(b,f),c);return h||a.assign(b,h={}),h[g]=e}})},functionCall:function(a,b){var c=[];if(")"!==this.peekToken().text)do c.push(this.expression());while(this.expect(","));this.consume(")");var d=this.text,e=c.length?[]:null;return function(f,g){var h=b?b(f,g):f,i=a(f,g,h)||qb;if(e)for(var j=c.length;j--;)e[j]=ub(c[j](f,g),d);ub(h,d),vb(i,d);var k=i.apply?i.apply(h,e):i(e[0],e[1],e[2],e[3],e[4]);return ub(k,d)}},arrayDeclaration:function(){var a=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;var b=this.expression();a.push(b)}while(this.expect(","));return this.consume("]"),ob(function(b,c){for(var d=[],e=0,f=a.length;f>e;e++)d.push(a[e](b,c));return d},{literal:!0,constant:a.every(wb),inputs:a})},object:function(){var a=[],b=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;var c=this.expect();a.push(c.string||c.text),this.consume(":");var d=this.expression();b.push(d)}while(this.expect(","));return this.consume("}"),ob(function(c,d){for(var e={},f=0,g=b.length;g>f;f++)e[a[f]]=b[f](c,d);return e},{literal:!0,constant:b.every(wb),inputs:b})}};var Wb=pb(),Xb=(Object.prototype.valueOf,function(){function a(a,b){return b?function(c,d){var e=a(c,d),f=b(e,c,d);return Q(e)?f:e}:a}var b=pb(),c={csp:!1};return function(d,e){var f,g,h;switch(typeof d){case"string":if(h=d=d.trim(),f=b[h],!f){":"===d.charAt(0)&&":"===d.charAt(1)&&(g=!0,d=d.substring(2));var i=new Ub(c),j=new Vb(i,c);f=j.parse(d),b[h]=f}return a(f,e);case"function":return a(d,e);default:return a(qb,e)}}}()),Yb=/^(?:value|identity)$/,Zb={STRING:["charAt","concat","indexOf","lastIndexOf","match","replace","slice","substr","substring","toLowerCase","toUpperCase"],ARRAY:["concat","join","pop","push","shift","sort","splice","unshift","indexOf","lastIndexOf"],NUMBER:["abs","ceil","cos","floor","round","sin","sqrt","pow","tan"]},$b={BASE:[{name:"add",action:W},{name:"value",action:nb}],OBJECT:[{name:"keys",action:Y},{name:"toArray",action:$},{name:"extend",action:ob},{name:"forEach",action:e}],STRING:[{name:"startsWith",action:fb},{name:"endsWith",action:_},{name:"trim",action:ib},{name:"ltrim",action:ab},{name:"rtrim",action:db},{name:"repeat",action:bb},{name:"slugify",action:eb},{name:"stringular",action:gb},{name:"stripTags",action:hb},{name:"truncate",action:jb},{name:"ucfirst",action:kb},{name:"wrap",action:lb},{name:"reverse",action:I}],ARRAY:[{name:"after",action:l},{name:"afterWhere",action:k},{name:"before",action:n},{name:"beforeWhere",action:m},{name:"contains",action:o},{name:"countBy",action:p},{name:"defaults",action:q},{name:"map",action:C},{name:"contains",action:o},{name:"find",action:w},{name:"findIndex",action:t},{name:"findLast",action:v},{name:"findLastIndex",action:u},{name:"first",action:x},{name:"last",action:B},{name:"flatten",action:y},{name:"every",action:r},{name:"groupBy",action:A},{name:"omit",action:F},{name:"filter",action:s},{name:"remove",action:H},{name:"reverse",action:I},{name:"unique",action:K},{name:"uniq",action:K},{name:"xor",action:L},{name:"max",action:D},{name:"min",action:E},{name:"sum",action:J},{name:"pluck",action:C},{name:"pick",action:s},{name:"some",action:o},{name:"orderBy",action:G},{name:"sortBy",action:G},{name:"forEach",action:e}]},_b=y([Zb.STRING,$b.STRING,$b.BASE]);Ab(Cb,_b,String.prototype);var ac=y([Zb.ARRAY,$b.ARRAY,$b.BASE]);Ab(Db,ac,Array.prototype);var bc=y([$b.OBJECT,$b.BASE]);Ab(Eb,bc,Object.prototype);var cc=y([Zb.NUMBER,$b.BASE]);Ab(Fb,cc,Math);var dc=y([$b.BASE,$b.ARRAY,$b.STRING,$b.OBJECT]);Bb(Hb,dc),Hb.isString=M,Hb.isObject=N,Hb.isNumber=O,Hb.isUndefined=P,Hb.isDefined=Q,Hb.isArray=Lb,Hb.isDate=R,Hb.isFunction=S,Hb.isEmpty=U,Hb.copy=sb,Hb.equals=mb,Hb.identity=nb,Hb.dictionary=pb,Hb.noop=qb,Hb.uppercase=Mb,Hb.lowercase=Nb,Hb.toJson=rb,Hb.parse=Xb,Ib(a)}(this);